<html>
<head>
<title>Clone Form Fake</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha256-KXn5puMvxCw+dAYznun+drMdG1IFl3agK0p/pqT9KAo= sha512-2e8qq0ETcfWRI4HJBzQiA3UoyFk6tbNyG+qSaIBZLyW9Xf3sWZHN/lxe9fTh1U45DpPf07yj94KsUHHWe4Yk1A==" crossorigin="anonymous"></script>
<script src="https://wtlv1-d0df.restdb.io/assets/js/jquery-serialize-object.min.js"></script>
<script src="https://wtlv1-d0df.restdb.io/assets/js/jquery.datetimepicker.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.5.1/lodash.min.js"></script>

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-7s5uDGW3AHqw6xtJmNNtr+OBRJUlgkNJEo78P4b0yRw= sha512-nNo+yCHEyn0smMxSswnf/OnX6/KwJuZTlNZBjauKhTK0c+zT+q5JOCx0UFhXQ6rJR9jg6Es8gPuD2uZcYDLqSw==" crossorigin="anonymous">
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-hQpvDQiCJaD2H465dQfA717v7lu5qHWtDbWNPvaTJ0ID5xnPUlVXnKzq7b8YUkbN" crossorigin="anonymous">
<link href="https://wtlv1-d0df.restdb.io/assets/css/jquery.datetimepicker.min.css" rel="stylesheet">
<link rel="icon" href="https://wtlv1-d0df.restdb.io/media/5791ff98139911750000236e">
<link rel="stylesheet" href="style.css">

</head>
<body class="public">
<div id="page">
<header class="clearfix">
    <div class="logo"></div>
    <div class="page-title text-center">
        <h1>Clone Example Form</h1>
    </div>
</header>
    
<div class="container-fluid text-center">
<form role="form" id="request-accounts-form">
        <br>
        <br>
    
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
            <div class="form-group">
                <label>Example Text Field: </label>
                <input id="token" class="form-control" name="token" data-type="text" type="text" readonly>
            </div>
            <div class="form-group">
                <label>Blank Example: </label>
                <input  class="form-control" data-type="text" type="text" readonly>
            </div>
        </div>
    </div>
    <div id="files">
        
    
    </div>
    
    <div class="row">
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 text-center"></div>
        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 text-center">
            <div class="form-group">
                <input id="tandc" class="checkbox-custom" name="checkbox-3" type="checkbox" onchange="document.getElementById('btn-submit').disabled = !this.checked;">
                    <label for="tandc" class="checkbox-custom-label"></label>
                    <div>
                        <p> The file input boxes are auto-generated by javascript. You can add files by clicking them or dragging files over them. The Submit button will be enabled by checking the tickbox above, but submitting the form will not send your files anywhere. This is just an example page. The Example Text Field relies on a URL token. You can fill it out by going to the same address as this page, plus "/?token=" followed by url encoded text you want to appear in the field. </p>
                    </div>
                </input>
            </div>
            <button class="btn btn-default btn-lg" id="btn-submit" type="submit" data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> Submitting..." disabled>Submit</button>
        </div>
    </div>
    </div>
</form>
</div>
</div>



  
  
  
<script>
    
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
    }

$(function () {
	var file_names_list = '';
	var storedFiles = {};
	var formID = 'request-accounts-form';
	var collectionID = 'request-accounts';
	
	function buttonlistener(item){
	   // item.removeEventListener("click", removeFile);
	    item.addEventListener("click", removeFile);
	}
	
	function removeFile(){
	    var ID = this.id.split('_button')[0];
	    var list = storedFiles[ID];
	    var index = this.id.split('-')[1];
	    console.log(list[index].name);
	    list.splice(index, 1);
	    if(list.length == 0){
	        console.log('no files');
            $('#' + ID + '_label').css('border', '0px solid black');
            $('#' + ID + '_box').css('background', 'none');
            document.getElementById(ID).value = "";
		    document.getElementById(ID).removeEventListener("dragleave", dragOffPrefilled);
		    document.getElementById(ID).addEventListener("dragleave", dragOff);
		    document.getElementById(ID).removeEventListener("mouseleave", dragOffPrefilled);
		    document.getElementById(ID).addEventListener("mouseleave", dragOff);
	    }
        var filename = '';
        var height = 0;
        for(var x = 0; x < list.length; x ++) {
                filename = filename + '<li><p class="fileLabel">' + list[x].name + '</p><button type="button" class="closebtn" id="' + ID + '_button_index-' + x + '">x</button></li>';
                height ++;
        }
        $('#' + ID).closest('.drop-box').children('.progress').css('margin-top', 0.5*height + 'em');
        $('#' + ID).closest('.drop-box').children('.plus').css('margin-top', 1 + height + 'em');
        $('#' + ID + '_box').css('height', 10 + 3*height + 'em');
        $('#' + ID + '_box').css('margin-bottom', '4em');
        $('#' + ID + '_label').html(filename);
        var buttons = Array.from(document.getElementsByClassName('closebtn'));
	    buttons.forEach(buttonlistener);
        console.log(list);
        storedFiles[ID] = list;
	}
	
	function listeners(item){
		item.addEventListener("dragleave", dragOff);
		item.addEventListener("dragover", dragOn);
		item.addEventListener("mouseleave", dragOff);
		item.addEventListener("mouseover", dragOn);
		item.addEventListener("drop", drop);
		item.addEventListener("change", changeFile);
	};
			
	function dragOn() {
        $('#' + this.id + '_box').css('background', 'rgba(0, 0, 0, 0.5)');
	};
			
	function drop() {
        $('#' + this.id + '_box').css('background', 'rgba(255, 255, 255, 0.5)');
	};
			
	function dragOff() {
        $('#' + this.id + '_box').css('background', 'none');
	};
			
	function dragOffPrefilled() {
        $('#' + this.id + '_box').css('background', 'rgba(255, 255, 255, 0.5)');
	};
			
    function changeFile() {
        var files = this.files;
        files = Array.prototype.slice.call(files);
        console.log(Object.getOwnPropertyNames(this.files[0]) + '___' + this.files[0]);
        // for(var index = 1; index < $('#' + this.id)[0].files.length; index ++) {
            if(storedFiles[this.id] && storedFiles[this.id].length > 0){
                for(var x = 0; x < files.length; x++){
                    storedFiles[this.id].push(files[x]);
                }
            } else{
                storedFiles[this.id] = files;
            }
            console.log(storedFiles[this.id]);
            // console.log('arr = ' + arr);
                // console.log(storedFiles[this.id][10].name);
                // console.log(storedFiles[this.id][2].name);
        // }
        this.removeEventListener('dragleave', dragOff);
        this.addEventListener('dragleave', dragOffPrefilled);
        this.removeEventListener('mouseleave', dragOff);
        this.addEventListener('mouseleave', dragOffPrefilled);
        var list = storedFiles[this.id];
        var filename = '';
        var height = 0;
        for(var index = 0; index < list.length; index ++) {
                console.log(storedFiles[this.id][index].name);
                filename = filename + '<li><p class="fileLabel">' + list[index].name + '</p><button type="button" class="closebtn" id="' + this.id + '_button_index-' + index + '">x</button></li>';
                height ++;
        }
        $(this).closest('.drop-box').children('.progress').css('margin-top', 0.5*height + 'em');
        $(this).closest('.drop-box').children('.plus').css('margin-top', 1 + height + 'em');
        $('#' + this.id + '_box').css('height', 10 + 3*height + 'em');
        $('#' + this.id + '_box').css('margin-bottom', '4em');
        $('#' + this.id + '_label').html(filename);
        $('#' + this.id + '_label').css('border', '0.27em solid black');
        $('#' + this.id + '_box').css('background', 'rgba(255,255,255,0.5)');
        $(this).data("uploadedfiles",[]);
        var buttons = Array.from(document.getElementsByClassName('closebtn'));
	    buttons.forEach(buttonlistener);
	    document.getElementById(this.id + "_label").addEventListener("dragover",function(e){
            e = e || event;
            e.preventDefault();
        },false);
        document.getElementById(this.id + "_label").addEventListener("drop",function(e){
            e = e || event;
            e.preventDefault();
        },false);
    }; 

  // put your own error messages and/or message translation logic here

  var errorMessages = {
    "REQUIRED": "This field is required",
    "UNIQUE": "This value already exists",
    "TYPE": "Invalid data type",
    "REGEX":"Invalid data format",
    "number": "Must be an integer number",
    "money": "Must be a number with max two decimals",
    "JSON":"Not a valid JSON",
    "float_number":"Must be a decimal number",
    "email": "Must be a valid email",
    "FILESIZE": "Upload exceeds file size limit per field (max 5 MB)",
    "UPLOADERROR": "Unable to upload file, please try again",
    "GENERIC_ERROR": "A server error occured, please reload page"
  }

  var successMessage = "Thank you!";

  // enable javascript datetimepicker unless supported
  // Docs and settings: http://xdsoft.net/jqplugins/datetimepicker/

  $.datetimepicker.setLocale('en');

  // if missing support for datetime, then use jquery.datetimepicker

  if (!Modernizr.inputtypes.datetime){
      $("input[data-type=date]").datetimepicker({timepicker:false,format:"Y/m/d"}).attr("type","text");
      $("input[data-type=datetime]").datetimepicker({}).attr("type","text");
      $("input[data-type=time]").datetimepicker({datepicker:false,format:"H:i",value:"12:00"}).attr("type","text");
  }
        var count = 0;
        var index = 0;
        var metadata = '<div class="row">';
        for(index = 0; index < 3; index ++){
                if(count == 0){
                    metadata += '<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">'
                }
                count ++;
                metadata += '<div class="form-group drop-box" id="upload' + index + '_box" name="<br><br><b>Example File Upload Field:</b><br>">' +
                    '<label>Example File Upload Field:</label>' +
                    '<input id="upload' + index + '" name="upload" type="file" data-type="file" class="form-control upload" multiple>' +
                    '<ul id="upload' + index + '_label">' +
                    '</ul>' +
                    '<p class="plus"><b>+</b></p>' +
                    '<div class="progress" hidden>' +
                        '<div id="upload' + index + '_progress" class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0">' +
                            '<span class="sr-only">0%</span>' +
                        '</div>' +
                    '</div>' +      
                '</div>';
                if (count == 1){
                    metadata += '</div>';
                    count = 0;
                }
        }        
        metadata += '</div>';
        // metadata += '<p>' + rmdr + '</p>';
        document.getElementById('files').innerHTML += metadata;
        document.getElementById('token').value = getParameterByName('token');
    
    var dragons = Array.from(document.getElementsByClassName('upload'));
	dragons.forEach(listeners);
    
    function dateFormat(dateString){
        var months = ["null", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec",];
        var splitArray = dateString.split('-');
        dateString = splitArray[2] + ' ' + months[parseInt(splitArray[1])] + ' ' + splitArray[0];
        return dateString;
    }
});
</script>
</body>
</html>